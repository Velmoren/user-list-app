<div class="container pt-3">
  <h4 class="mb-5 text-center text-sm-left">Создание пользователя</h4>
  <form action="" class="w-100" [formGroup]="createUserForm" (ngSubmit)="submit()">
    <div class="row">

      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="input-name">Имя</label>
          <div class="input-group">
            <input
              id="input-name"
              class="form-control"
              type="text"
              formControlName="name"
            >
          </div>
          <div *ngIf="name?.invalid && (name?.touched || name?.dirty)">
            <small class="form-error-text" *ngIf="name?.errors?.['required']">
              Поле имя не может быть пустым
            </small>
          </div>
        </div>
      </div>

      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="input-email">Email</label>
          <div class="input-group">
            <input
              id="input-email"
              class="form-control"
              type="email"
              formControlName="email"
            >
          </div>
          <div *ngIf="email?.invalid && (email?.touched || email?.dirty)">
            <small class="form-error-text" *ngIf="email?.errors?.['required']">
              Поле email не может быть пустым
            </small>

            <small class="form-error-text" *ngIf="email?.errors?.['email']">
              Введите корректный email
            </small>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="input-password">Пароль</label>
          <div class="input-group">
            <input
              id="input-password"
              class="form-control"
              type="text"
              formControlName="password"
            >
          </div>
          <div
            *ngIf="password?.invalid && (password?.touched || password?.dirty)"
            class="validation"
          >
            <small class="form-error-text" *ngIf="password?.errors?.['required']">
              Поле password не может быть пустым
            </small>

            <small class="form-error-text" *ngIf="password?.errors?.['required']">
              Passwords do not match
            </small>

            <small class="form-error-text" *ngIf="password?.errors?.['minlength']">
              Длина вашего пароля {{password?.errors?.['minlength']['actualLength']}}. Пароль должен быть
              минимум {{password?.errors?.['minlength']['requiredLength']}} символов!
            </small>
          </div>
        </div>
      </div>

      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="input-confirm-password">Повторите пароль</label>
          <div class="input-group">
            <input
              id="input-confirm-password"
              class="form-control"
              type="text"
              formControlName="confirmPassword"
            >
          </div>
          <div
            *ngIf="createUserForm.hasError('notSame') && (confirmPassword?.touched || confirmPassword?.dirty)"
            class="validation"
          >
            <small class="form-error-text">
              Пароли не совпадают
            </small>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="inputState">Роль</label>
          <select id="inputState" class="form-control" formControlName="permission">
            <option selected value="">Выбрать роль</option>
            <option value="admin">admin</option>
            <option value="user">user</option>
          </select>
          <div *ngIf="permission?.invalid && (permission?.touched || permission?.dirty)">
            <small class="form-error-text" *ngIf="permission?.errors?.['required']">
              Поле Роль - обязательное
            </small>
          </div>
        </div>
      </div>

      <div class="col col-12 col-md-6">
        <div class="form-group">
          <label for="inputState">Аватар пользователя</label>
          <div class="custom-file mb-3">
            <input
              type="file"
              class="custom-file-input"
              id="validatedCustomFile"
              (input)="onSelectAvatar($event)"
            >
            <label class="custom-file-label" for="validatedCustomFile">{{userAvatarFile}}</label>
          </div>
        </div>
      </div>
    </div>

    <div class="row" formArrayName="skills">
      <div class="col col-12">
        <div class="btn-group" role="group" aria-label="Basic example">
          <button
            (click)="addSkillGroup()"
            class="btn btn-success btn-sm"
          ><i class="bi bi-plus-square"></i></button>
          <button
            (click)="removeSkillGroup()"
            class="btn btn-danger btn-sm"
          ><i class="bi bi-dash-square"></i></button>
        </div>
      </div>
      <div class="col col-12">
        <div class="row" *ngFor="let control of skillsControls.controls; let i = index" [formGroupName]="i">
          <div class="col col-12">
            <div class="form-group">
              <label for="input-email">Место учебы</label>
              <div class="input-group">
                <input id="input-skill" class="form-control" type="text" formControlName="name">
              </div>
            </div>
          </div>
          <div class="col col-6">
            <div class="form-group">
              <label for="input-email">Дата начала</label>
              <div class="input-group">
                <input id="input-startAge" class="form-control" type="text" formControlName="startAge">
              </div>
            </div>
          </div>
          <div class="col col-6">
            <div class="form-group">
              <label for="input-email">Дата завершения</label>
              <div class="input-group">
                <input id="input-endAge" class="form-control" type="text" formControlName="endAge">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col col-12">
        <button
          type="submit"
          class="btn btn-dark btn-custom-block"
          [disabled]="createUserForm.invalid || submitted"
        >Отправить
        </button>
      </div>
    </div>
  </form>
</div>
